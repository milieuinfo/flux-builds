"use strict";(self.webpackChunkstorybook=self.webpackChunkstorybook||[]).push([[3876,6369],{"../../node_modules/vidstack/prod/providers/vidstack-dash.js":(t,e,i)=>{i.r(e),i.d(e,{DASHProvider:()=>f});var s=i("../../node_modules/vidstack/prod/chunks/vidstack-vDnjyKV8.js"),n=i("../../node_modules/vidstack/prod/chunks/vidstack-DyMkFGuS.js"),a=i("../../node_modules/vidstack/prod/providers/vidstack-video.js"),r=i("../../node_modules/vidstack/prod/chunks/vidstack-CRlI3Mh7.js"),o=i("../../node_modules/vidstack/prod/chunks/vidstack-B01xzxC4.js"),d=i("../../node_modules/vidstack/prod/chunks/vidstack-B5628Ni3.js"),c=i("../../node_modules/vidstack/prod/chunks/vidstack-D5EzK014.js"),h=i("../../node_modules/vidstack/prod/chunks/vidstack-DSYpsFWk.js"),l=i("../../node_modules/vidstack/prod/chunks/vidstack-C9vIqaYT.js");function u(t){try{return new Intl.DisplayNames(navigator.languages,{type:"language"}).of(t)??null}catch(t){return null}}let p=t=>`dash-${(0,r.BW)(t)}`;class v{#t;#e;#i=null;#s=new Set;#n=null;config={};get instance(){return this.#i}constructor(t,e){this.#t=t,this.#e=e}setup(t){this.#i=t().create();let e=this.#a.bind(this);for(let i of Object.values(t.events))this.#i.on(i,e);for(let e of(this.#i.on(t.events.ERROR,this.#r.bind(this)),this.#s))e(this.#i);this.#e.player.dispatch("dash-instance",{detail:this.#i}),this.#i.initialize(this.#t,void 0,!1),this.#i.updateSettings({streaming:{text:{defaultEnabled:!1,dispatchForManualRendering:!0},buffer:{fastSwitchEnabled:!0}},...this.config}),this.#i.on(t.events.FRAGMENT_LOADING_STARTED,this.#o.bind(this)),this.#i.on(t.events.FRAGMENT_LOADING_COMPLETED,this.#d.bind(this)),this.#i.on(t.events.MANIFEST_LOADED,this.#c.bind(this)),this.#i.on(t.events.QUALITY_CHANGE_RENDERED,this.#h.bind(this)),this.#i.on(t.events.TEXT_TRACKS_ADDED,this.#l.bind(this)),this.#i.on(t.events.TRACK_CHANGE_RENDERED,this.#u.bind(this)),this.#e.qualities[o.k.enableAuto]=this.#p.bind(this),(0,r.k6)(this.#e.qualities,"change",this.#v.bind(this)),(0,r.k6)(this.#e.audioTracks,"change",this.#g.bind(this)),this.#n=(0,r.QZ)(this.#k.bind(this))}#y(t){return new r.vP(p(t.type),{detail:t})}#k(){if(!this.#e.$state.live())return;let t=new h.e(this.#m.bind(this));return t.start(),t.stop.bind(t)}#m(){if(!this.#i)return;let t=this.#i.duration()-this.#i.time();this.#e.$state.liveSyncPosition.set(isNaN(t)?1/0:t)}#a(t){this.#e.player?.dispatch(this.#y(t))}#f=null;#x={};#T(t){let e=this.#f?.[d.Hp.native],i=(e?.track).cues;if(!e||!i)return;let s=this.#f.id,n=this.#x[s]??0,a=this.#y(t);for(let t=n;t<i.length;t++){let e=i[t];e.positionAlign||(e.positionAlign="auto"),this.#f.addCue(e,a)}this.#x[s]=i.length}#l(t){if(!this.#i)return;let e=t.tracks,i=[...this.#t.textTracks].filter(t=>"manualMode"in t),s=this.#y(t);for(let t=0;t<i.length;t++){let n=e[t],a=i[t],r=`dash-${n.kind}-${t}`,o=new d.to({id:r,label:n?.label??n.labels.find(t=>t.text)?.text??(n?.lang&&u(n.lang))??n?.lang??void 0,language:n.lang??void 0,kind:n.kind,default:n.defaultTrack});o[d.Hp.native]={managed:!0,track:a},o[d.Hp.readyState]=2,o[d.Hp.onModeChange]=()=>{this.#i&&("showing"===o.mode?(this.#i.setTextTrack(t),this.#f=o):(this.#i.setTextTrack(-1),this.#f=null))},this.#e.textTracks.add(o,s)}}#u(t){let{mediaType:e,newMediaInfo:i}=t;if("audio"===e){let e=this.#e.audioTracks.getById(`dash-audio-${i.index}`);if(e){let i=this.#y(t);this.#e.audioTracks[c.j.select](e,!0,i)}}}#h(t){if("video"!==t.mediaType)return;let e=this.#e.qualities[t.newQuality];if(e){let i=this.#y(t);this.#e.qualities[c.j.select](e,!0,i)}}#c(t){if(this.#e.$state.canPlay()||!this.#i)return;let{type:e,mediaPresentationDuration:i}=t.data,s=this.#y(t);this.#e.notify("stream-type-change","static"!==e?"live":"on-demand",s),this.#e.notify("duration-change",i,s),this.#e.qualities[o.k.setAuto](!0,s);let a=this.#i.getVideoElement(),d=this.#i.getTracksForTypeFromManifest("video",t.data),h=[...new Set(d.map(t=>t.mimeType))].find(t=>t&&(0,n.EI)(a,t)),l=d.filter(t=>h===t.mimeType)[0],p=this.#i.getTracksForTypeFromManifest("audio",t.data),v=[...new Set(p.map(t=>t.mimeType))].find(t=>t&&(0,n.Te)(a,t));if(p=p.filter(t=>v===t.mimeType),l.bitrateList.forEach((t,e)=>{let i={id:t.id?.toString()??`dash-bitrate-${e}`,width:t.width??0,height:t.height??0,bitrate:t.bandwidth??0,codec:l.codec,index:e};this.#e.qualities[c.j.add](i,s)}),(0,r.Et)(l.index)){let t=this.#e.qualities[l.index];t&&this.#e.qualities[c.j.select](t,!0,s)}p.forEach((t,e)=>{let i=t.labels.find(t=>navigator.languages.some(e=>t.lang&&e.toLowerCase().startsWith(t.lang.toLowerCase())))||t.labels[0],n={id:`dash-audio-${t?.index}`,label:i?.text??(t.lang&&u(t.lang))??t.lang??"",language:t.lang??"",kind:"main",mimeType:t.mimeType,codec:t.codec,index:e};this.#e.audioTracks[c.j.add](n,s)}),a.dispatchEvent(new r.vP("canplay",{trigger:s}))}#r(t){let{type:e,error:i}=t;27===i.code?this.#b(i):this.#E(i)}#o(){this.#w>=0&&this.#S()}#d(t){"text"===t.mediaType&&requestAnimationFrame(this.#T.bind(this,t))}#w=-1;#b(t){this.#S(),this.#i?.play(),this.#w=window.setTimeout(()=>{this.#w=-1,this.#E(t)},5e3)}#S(){clearTimeout(this.#w),this.#w=-1}#E(t){this.#e.notify("error",{message:t.message??"",code:1,error:t})}#p(){this.#L("video",!0);let{qualities:t}=this.#e;this.#i?.setQualityFor("video",t.selectedIndex,!0)}#L(t,e){this.#i?.updateSettings({streaming:{abr:{autoSwitchBitrate:{[t]:e}}}})}#v(){let{qualities:t}=this.#e;this.#i&&!t.auto&&t.selected&&(this.#L("video",!1),this.#i.setQualityFor("video",t.selectedIndex,"current"===t.switch),n.G_&&(this.#t.currentTime=this.#t.currentTime))}#g(){if(!this.#i)return;let{audioTracks:t}=this.#e,e=this.#i.getTracksFor("audio").find(e=>t.selected&&t.selected.id===`dash-audio-${e.index}`);e&&this.#i.setCurrentTrack(e)}#P(){this.#S(),this.#f=null,this.#x={}}onInstance(t){return this.#s.add(t),()=>this.#s.delete(t)}loadSource(t){this.#P(),(0,r.Kg)(t.src)&&this.#i?.attachSource(t.src)}destroy(){this.#P(),this.#i?.destroy(),this.#i=null,this.#n?.(),this.#n=null}}class g{#M;#e;#D;constructor(t,e,i){this.#M=t,this.#e=e,this.#D=i,this.#A()}async #A(){let t={onLoadStart:this.#C.bind(this),onLoaded:this.#j.bind(this),onLoadError:this.#_.bind(this)},e=await y(this.#M,t);return((0,r.b0)(e)&&!(0,r.Kg)(this.#M)&&(e=await k(this.#M,t)),e)?window.dashjs.supportsMediaSource()?e:(this.#e.player.dispatch(new r.vP("dash-unsupported")),this.#e.notify("error",{message:"[vidstack] `dash.js` is not supported in this environment",code:4}),null):null}#C(){this.#e.player.dispatch(new r.vP("dash-lib-load-start"))}#j(t){this.#e.player.dispatch(new r.vP("dash-lib-loaded",{detail:t})),this.#D(t)}#_(t){let e=(0,l.r)(t);this.#e.player.dispatch(new r.vP("dash-lib-load-error",{detail:e})),this.#e.notify("error",{message:e.message,code:4,error:e})}}async function k(t,e={}){if(!(0,r.b0)(t)){var i;if(e.onLoadStart?.(),(i=t)&&t.prototype&&t.prototype!==Function)return e.onLoaded?.(t),t;if(m(t)){let i=t.MediaPlayer;return e.onLoaded?.(i),i}try{let i=(await t())?.default;if(m(i))return e.onLoaded?.(i.MediaPlayer),i.MediaPlayer;if(i)e.onLoaded?.(i);else throw Error("");return i}catch(t){e.onLoadError?.(t)}}}async function y(t,e={}){if((0,r.Kg)(t)){e.onLoadStart?.();try{if(await (0,s.k0)(t),!(0,r.Tn)(window.dashjs.MediaPlayer))throw Error("");let i=window.dashjs.MediaPlayer;return e.onLoaded?.(i),i}catch(t){e.onLoadError?.(t)}}}function m(t){return t&&"MediaPlayer"in t}class f extends a.VideoProvider{$$PROVIDER_TYPE="DASH";#F=null;#R=new v(this.video,this.ctx);get ctor(){return this.#F}get instance(){return this.#R.instance}static supported=(0,n.Hh)();get type(){return"dash"}get canLiveSync(){return!0}#I="https://cdn.jsdelivr.net/npm/dashjs@4.7.4/dist/dash.all.min.js";get config(){return this.#R.config}set config(t){this.#R.config=t}get library(){return this.#I}set library(t){this.#I=t}preconnect(){(0,r.Kg)(this.#I)&&(0,s.kZ)(this.#I)}setup(){super.setup(),new g(this.#I,this.ctx,t=>{this.#F=t,this.#R.setup(t),this.ctx.notify("provider-setup",this);let e=(0,r.se)(this.ctx.$state.source);e&&this.loadSource(e)})}async loadSource(t,e){if(!(0,r.Kg)(t.src)){this.removeSource();return}this.media.preload=e||"",this.appendSource(t,"application/x-mpegurl"),this.#R.loadSource(t),this.currentSrc=t}onInstance(t){let e=this.#R.instance;return e&&t(e),this.#R.onInstance(t)}destroy(){this.#R.destroy()}}},"../../node_modules/vidstack/prod/providers/vidstack-video.js":(t,e,i)=>{i.r(e),i.d(e,{VideoProvider:()=>p});var s=i("../../node_modules/vidstack/prod/chunks/vidstack-CRlI3Mh7.js"),n=i("../../node_modules/vidstack/prod/chunks/vidstack-DyMkFGuS.js"),a=i("../../node_modules/vidstack/prod/providers/vidstack-html.js"),r=i("../../node_modules/vidstack/prod/chunks/vidstack-CSv7rfHP.js"),o=i("../../node_modules/vidstack/prod/chunks/vidstack-B5628Ni3.js");class d{#t;#e;constructor(t,e){this.#t=t,this.#e=e,t.textTracks.onaddtrack=this.#H.bind(this),(0,s.zp)(this.#N.bind(this))}#H(t){var e,i;let s=t.track;if(!s||(e=this.#t,i=s,Array.from(e.children).find(t=>t.track===s)))return;let n=new o.to({id:s.id,kind:s.kind,label:s.label??"",language:s.language,type:"vtt"});n[o.Hp.native]={track:s},n[o.Hp.readyState]=2,n[o.Hp.nativeHLS]=!0;let a=0,r=t=>{if(s.cues)for(let e=a;e<s.cues.length;e++)n.addCue(s.cues[e],t),a++};r(t),s.oncuechange=r,this.#e.textTracks.add(n,t),n.setMode(s.mode,t)}#N(){for(let t of(this.#t.textTracks.onaddtrack=null,this.#e.textTracks)){let e=t[o.Hp.native]?.track;e?.oncuechange&&(e.oncuechange=null)}}}class c{#t;#O;constructor(t,e){this.#t=t,this.#O=e,new s.En(t).add("enterpictureinpicture",this.#$.bind(this)).add("leavepictureinpicture",this.#q.bind(this))}get active(){return document.pictureInPictureElement===this.#t}get supported(){return(0,n.dE)(this.#t)}async enter(){return this.#t.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}#$(t){this.#Q(!0,t)}#q(t){this.#Q(!1,t)}#Q=(t,e)=>{this.#O.notify("picture-in-picture-change",t,e)}}class h{#t;#O;#B="inline";get mode(){return this.#B}constructor(t,e){this.#t=t,this.#O=e,(0,s.k6)(t,"webkitpresentationmodechanged",this.#G.bind(this))}get supported(){return(0,n.Jt)(this.#t)}async setPresentationMode(t){this.#B!==t&&this.#t.webkitSetPresentationMode(t)}#G(t){let e=this.#B;this.#B=this.#t.webkitPresentationMode,this.#O.player?.dispatch(new s.vP("video-presentation-change",{detail:this.#B,trigger:t})),["fullscreen","picture-in-picture"].forEach(i=>{(this.#B===i||e===i)&&this.#O.notify(`${i}-change`,this.#B===i,t)})}}class l{#K;get active(){return"fullscreen"===this.#K.mode}get supported(){return this.#K.supported}constructor(t){this.#K=t}async enter(){this.#K.setPresentationMode("fullscreen")}async exit(){this.#K.setPresentationMode("inline")}}class u{#K;get active(){return"picture-in-picture"===this.#K.mode}get supported(){return this.#K.supported}constructor(t){this.#K=t}async enter(){this.#K.setPresentationMode("picture-in-picture")}async exit(){this.#K.setPresentationMode("inline")}}class p extends a.B{$$PROVIDER_TYPE="VIDEO";get type(){return"video"}airPlay;fullscreen;pictureInPicture;constructor(t,e){super(t,e),(0,s.P1)(()=>{if(this.airPlay=new r.z(t,e),(0,n.Jt)(t)){let i=new h(t,e);this.fullscreen=new l(i),this.pictureInPicture=new u(i)}else(0,n.dE)(t)&&(this.pictureInPicture=new c(t,e))},this.scope)}setup(){super.setup(),(0,n.uo)(this.video)&&new d(this.video,this.ctx),this.ctx.textRenderers.attachVideo(this.video),(0,s.zp)(()=>{this.ctx.textRenderers.attachVideo(null)}),"video"===this.type&&this.ctx.notify("provider-setup",this)}get video(){return this.media}}}}]);