"use strict";(self.webpackChunkstorybook=self.webpackChunkstorybook||[]).push([[7280],{"./docs/d_planning/2_aanpak_v2_v3.stories.mdx":(e,n,o)=>{o.r(n),o.d(n,{__namedExportsOrder:()=>c,__page:()=>s,default:()=>l}),o("../../node_modules/react/index.js");var i=o("../../node_modules/@storybook/addon-docs/node_modules/@mdx-js/react/lib/index.js"),t=o("../../node_modules/@storybook/blocks/dist/index.mjs"),r=o("../../node_modules/react/jsx-runtime.js");function d(e){let n=Object.assign({h1:"h1",h2:"h2",ul:"ul",li:"li",a:"a",p:"p",h3:"h3",code:"code",strong:"strong"},(0,i.RP)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.W8,{title:"Planning/Aanpak v2, v3, ..."}),"\n",(0,r.jsx)(n.h1,{id:"aanpak-v2-v3-",children:"Aanpak v2, v3, ..."}),"\n",(0,r.jsx)(n.h2,{id:"inhoudstafel",children:"Inhoudstafel"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#waarom-v2",children:"Waarom v2"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#waarom-next-componenten",children:"Waarom Next Componenten"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#next-conventies",children:"Next Conventies"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#v2-vs-v3",children:"v2 vs. v3"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#v2-release",children:"v2 Release"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#v3-release",children:"v3 Release"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"waarom-v2",children:"Waarom v2"}),"\n",(0,r.jsxs)(n.p,{children:["De basis van de code die er is ",(0,r.jsx)(n.a,{href:"/docs/historiek-toekomst--documentatie",children:"dateert"})," van 2020. Er is toen vertrokken\nvanuit het idee de code van ",(0,r.jsx)(n.a,{href:"https://overheid.vlaanderen.be/webuniversum/v3/",target:"_blank",rel:"nofollow noopener noreferrer",children:"Webuniversum v3"})," as-is af te nemen.\nDit had een aantal gevolgen:"]}),"\n",(0,r.jsx)(n.h3,{id:"element-complicatie",children:"Element complicatie"}),"\n",(0,r.jsxs)(n.p,{children:["Componenten zoals de DV ",(0,r.jsx)(n.a,{href:"https://overheid.vlaanderen.be/webuniversum/v3/documentation/atoms/vl-ui-button",target:"_blank",rel:"nofollow noopener noreferrer",children:"vl-ui-button"}),"\nmoeten als een uitbreiding op een native button geïmplementeerd worden. De Flux web-component moet dus extenden van\nHTMLButtonElement. De rede is dat de scss van DV enkel werkt op een ",(0,r.jsx)(n.code,{children:"button"})," tag, een custom component maken met als\ntag ",(0,r.jsx)(n.code,{children:"vl-button"})," werkt niet (de css die DV voorziet is daarvoor niet correct). Er was wel de mogelijkheid geweest om de\ncomponent te schrijven als wrapper: een ",(0,r.jsx)(n.code,{children:"vl-button"})," die dan daarin een ",(0,r.jsx)(n.code,{children:"button"})," rendert, maar die keuze is toen niet\ngemaakt."]}),"\n",(0,r.jsx)(n.p,{children:"Die keuze, om dus de vl-button als een uitbreiding op een button te implementeren, heeft een aantal gevolgen:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["afnemers moeten dit type componenten op een specifieke manier gebruiken: m.b.v. het ",(0,r.jsx)(n.code,{children:"is="})," attribuut, zie\n",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/is",target:"_blank",rel:"nofollow noopener noreferrer",children:"https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/is"})]}),"\n",(0,r.jsxs)(n.li,{children:["Safari gaat dit nooit ondersteunen, we moeten de polyfill ",(0,r.jsx)(n.code,{children:"@ungap/custom-elements"})," voorzien om dat in Safari te\nondersteunen"]}),"\n",(0,r.jsxs)(n.li,{children:["bestaande web-component frameworks: bvb. ",(0,r.jsx)(n.a,{href:"https://lit.dev/",target:"_blank",rel:"nofollow noopener noreferrer",children:"Lit"})," en ",(0,r.jsx)(n.a,{href:"https://stenciljs.com/docs/introduction",target:"_blank",rel:"nofollow noopener noreferrer",children:"Stencil"}),"\nondersteunen het niet; overal LitElement (om consistent te zijn) als basis klasse gebruiken kan dus niet"]}),"\n",(0,r.jsx)(n.li,{children:"omdat op die manier - aan native elementen - extra attributen toegevoegd worden door de implementatie, en om\ntegelijkertijd aan de HTML5 standaard te voldoen, is er gekozen de nieuwe attributen te prefixen met 'data-'; dit is\ndan (om consistentie redenen) bij alle componenten zo doorgevoerd - terwijl dat voor componenten met een custom-tag\ngeen verplichting (en eigenlijk niet de bedoeling) is"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Opmerking: om duidelijk te maken of een bepaalde component gebruikt moet worden via een ",(0,r.jsx)(n.code,{children:"custom tag"})," of via het ",(0,r.jsx)(n.code,{children:"is="}),"\nattribuut zijn in de nieuwe ",(0,r.jsx)(n.code,{children:"@domg-wc"})," componenten (v1.x.x) alle componenten, die als uitbreiding op een native tag\ngeïmplementeerd zijn, gegroepeerd in het ",(0,r.jsx)(n.code,{children:"@domg-wc/elements"})," artifact."]}),"\n",(0,r.jsx)(n.h3,{id:"javascript-complicatie",children:"JavaScript complicatie"}),"\n",(0,r.jsx)(n.p,{children:"Een aantal DV componenten bevatten JavaScript. Die is deels door DV zelf geschreven en deels afkomstig van andere\nbibliotheken. De DV specifieke JavaScript voorziet een soort van lifecycle waarbij componenten 'ge-dressed' worden.\nDoordat er soms 'patches' dienden te gebeuren (en vermoedelijk om consistent te zijn) is uiteindelijk de meeste van\ndie JavaScript in onze code-base als code beland, dus niet als dependency naar DV- of externe artifacts. Dit heeft\nvolgende gevolgen:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"upgrades zijn moeilijk, doordat 'onze' JavaScript afwijkt van deze van DV kunnen we niet zomaar de meest recente\nversie binnentrekken - we zouden deze moeten diffen, copy-pasten en aanpassen"}),"\n",(0,r.jsx)(n.li,{children:"er zijn rechten issues: omdat die JavaScript code een mix is van DV- en externe code weten we de bron en\nde versie niet, we kunnen dus niet controleren of de licentie van die code wel toestaat dat we ze overnemen"}),"\n",(0,r.jsxs)(n.li,{children:["de eigen DV-lifecycle is niet eenduidig en dus moeilijk correct te laten samen werken met de\n",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements#custom_element_lifecycle_callbacks",target:"_blank",rel:"nofollow noopener noreferrer",children:"web-components lifecycle"}),"\nof de ",(0,r.jsx)(n.a,{href:"https://lit.dev/docs/components/lifecycle/",target:"_blank",rel:"nofollow noopener noreferrer",children:"Lit lifecycle"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scss-complicatie",children:"SCSS complicatie"}),"\n",(0,r.jsx)(n.p,{children:"DV voorziet alle css is scss formaat, hierdoor kunnen ze gestructureerde css schrijven met mixins, variabelen,\nnesting, ... . Dit heeft wel gevolgen bij ons:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["wij moeten die scss omzetten naar css, ofwel door een plugin in de build (wat we vroeger deden) ofwel door zelf een\npre-process'de bibliotheek te voorzien (wat we tegenwoordig doen via ",(0,r.jsx)(n.code,{children:"@domg/govflanders-style"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"scss is geen 'standaard', wat toch 1 van de basis principes is van de keuzes gemaakt in 2020"}),"\n",(0,r.jsx)(n.li,{children:"Lit - wat we als uniforme basis nemen - ondersteunt geen scss"}),"\n",(0,r.jsx)(n.li,{children:"de fragmentatie door DV van de scss is niet goed om web componenten te schrijven: bij normaal gebruik wordt alle scss\nnodig voor een website op 1 plaats geïmporteerd, op die manier krijg je minimale duplicatie.\nWeb-componenten zijn echter self contained, elke component bevat alles wat hij nodig heeft, het gevolg is dat we\nin elke component alle 'gedeelde' css krijgen, daarin zit vaak overbodige css (voor die component)\nen over componenten heen is er nodeloze duplicatie."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"waarom-next-componenten",children:"Waarom 'Next' Componenten"}),"\n",(0,r.jsx)(n.p,{children:"Om de componenten af te nemen, maar ook om ze te implementeren, is eenduidigheid belangrijk. We proberen de\nFlux-componenten zo backwards compatibel als mogelijk te laten evolueren. Echter, om alles eenduidig te maken,\nzullen we backwards incompatibele wijzigingen moeten doorvoeren."}),"\n",(0,r.jsx)(n.p,{children:"Op zich zouden we dat kunnen doen door een fork te maken van de huidige code en in die fork aan een v2 release te\nwerken. Op die manier werken leek ons niet realistisch:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"voor de componenten die niet (of beperkt) wijzigen moeten bugfixes en features op 2 plaatsen gebeuren"}),"\n",(0,r.jsx)(n.li,{children:"als we componenten maar in v2 opnemen als ze volledig klaar zijn gaat het jaren duren voor alle componenten\n(inclusief de map) er in zitten"}),"\n",(0,r.jsx)(n.li,{children:"we gaan niet kunnen (en niet willen) garanderen dat v2 en v1 componenten volledig samenwerken, afnemers gaan dus\nmoeten kiezen, maar niemand zal v2 willen / kunnen afnemen zolang die versie niet de bulk van de componenten bevat"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Vandaar hebben we er dus voor gekozen om 'next'-componenten te introduceren. We laten de huidige versie van een\ncomponent bestaan en verder evolueren. Een nieuwe versie implementeren we in de huidige codebase en geven we\neen nieuwe tag door deze te suffixen met '-next'."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"opmerking 1:"})," We hebben bekeken of we dezelfde tag zouden kunnen gebruiken voor de oude en de nieuwe component,\ndan zou het afhangen van de import welke component je gebruikt.\nDoordat je een tag maar 1 maal kan registreren (het is dus de oude of de nieuwe component) en er componenten zijn\ndie zelf andere componenten importeren (en dus registreren) zou je at-runtime overal, fundamenteel, voor de ene of\nde andere moeten kiezen. Dit zou onze code, maar ook afnemers hun code veel te hard impacteren (vooral in de\novergangsfase)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"opmerking 2:"})," We hebben ook bekeken of we\n",(0,r.jsx)(n.a,{href:"https://github.com/WICG/webcomponents/blob/gh-pages/proposals/Scoped-Custom-Element-Registries.md",target:"_blank",rel:"nofollow noopener noreferrer",children:"scoped elements"}),"\nkonden gebruiken, zodat we dezelfde tag konden behouden voor de nieuwe en de oude versie. Dit is echter een voorstel\nmet een ",(0,r.jsx)(n.a,{href:"https://www.npmjs.com/package/@webcomponents/scoped-custom-element-registry",target:"_blank",rel:"nofollow noopener noreferrer",children:"polyfill prototype"})," implementatie.\nDeze oplossing ging technisch complex zijn voor de afnemers en gaf ook moeilijkheden met onze globale css (ook daar\nheb je een oude en een nieuwe versie van)."]}),"\n",(0,r.jsx)(n.h2,{id:"next-conventies",children:"'Next' Conventies"}),"\n",(0,r.jsx)(n.p,{children:"Volgende keuzes zijn gemaakt om door te voeren in de 'next'-componenten. Hierdoor wijken ze momenteel af van de andere\ncomponenten. Bij de feitelijke v2 release zullen we de andere componenten in lijn brengen (ook bij deze de next\nconventies doorvoeren)."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"een component heeft een custom tag die begint met 'vl-'"}),"\n",(0,r.jsx)(n.li,{children:"een component extend altijd van LitElement (en heeft daardoor de Lit-lifecycle)"}),"\n",(0,r.jsx)(n.li,{children:"css wordt geschreven als css-in-ts en aangeboden als css-in-js; we voorzien mixins als JavaScript methodes en\ngebruiken standaard css variabelen"}),"\n",(0,r.jsxs)(n.li,{children:["styling wordt aangeboden als css, pure styling wordt niet meer als element of component aangeboden maar gewoon als\ncss die je via het ",(0,r.jsx)(n.code,{children:"class="})," attribuut moet gebruiken"]}),"\n",(0,r.jsxs)(n.li,{children:["het 'element' concept verdwijnt, componenten die een native element extenden (dus met het ",(0,r.jsx)(n.code,{children:"is="})," attribuut gebruikt\nmoeten worden) worden stelselmatig weggewerkt:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"het element wordt in de next-variant een component"}),"\n",(0,r.jsx)(n.li,{children:"als het element in een form gebruikt werd komt de next-variant in de form artifact"}),"\n",(0,r.jsx)(n.li,{children:"het element wordt een css klasse"}),"\n",(0,r.jsx)(n.li,{children:"het element wordt geschrapt"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["de ",(0,r.jsx)(n.code,{children:"data-"})," prefix bij de attributen verdwijnt omdat er geen nood meer aan is"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"v2-vs-v3",children:"v2 vs. v3"}),"\n",(0,r.jsx)(n.p,{children:"In v2 zullen er nog:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"componenten zijn die extenden van BaseElementOfType"}),"\n",(0,r.jsx)(n.li,{children:"is de map nog niet conform de nieuwe conventies"}),"\n",(0,r.jsx)(n.li,{children:"is er nog legacy code"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"In versie 3 (hopelijk) zal de volledige codebase consistent zijn en wordt alle legacy code geschrapt ."}),"\n",(0,r.jsx)(n.h2,{id:"v2-release",children:"v2 Release"}),"\n",(0,r.jsxs)(n.p,{children:["Zolang we in v1 zaten kwamen er nieuwe 'next' componenten bij (zie\n",(0,r.jsx)(n.a,{href:"http://localhost:8080/?path=/docs/afnemen-migratie-v2-impact--documentatie",target:"_blank",rel:"nofollow noopener noreferrer",children:"Migratie v2 - Impact"}),"). De bestaande\ncomponenten bleven zoals ze geschreven waren, hun API wijzigde niet."]}),"\n",(0,r.jsx)(n.p,{children:"Bij de v2 release deden we het volgende:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["als er een oude en een nieuwe variant was van dezelfde component werd de oude geschrapt en bij de nieuwe werd\nde ",(0,r.jsx)(n.code,{children:"-next"})," suffix verwijderd - de nieuwe vervangt dus de oude; hierdoor is de component niet backwards\ncompatibel"]}),"\n",(0,r.jsxs)(n.li,{children:["bij de componenten die behouden bleven schrappen we de ",(0,r.jsx)(n.code,{children:"data-"})," prefix, zodat er in v2 nergens nog attributen zijn\ndie die conventie volgen"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"opmerking 1"}),": alle componenten die in release v2 zitten zitten ook in de laatste v1 release, er zullen\ner echter minder in v2 zitten (de oude worden geschrapt) en ze zullen anders gebruikt moeten worden - de ",(0,r.jsx)(n.code,{children:"button"}),"\nbvb. moet je niet meer gebruiken m.b.v. ",(0,r.jsx)(n.code,{children:'is="vl-button"'})," maar met de ",(0,r.jsx)(n.code,{children:"vl-button"})," tag"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"opmerking 2"}),": in v2.0.0 zitten geen next-componenten meer, maar vanaf v2.1.0 kunnen er nieuwe next-componenten\nkomen, deze volgen dan dezelfde conventie: in v3 zullen deze de oude v2 versie vervangen - het doel is wel om dit te\nbeperken tot de 'map' componenten"]}),"\n",(0,r.jsx)(n.h2,{id:"v3-release",children:"v3 Release"}),"\n",(0,r.jsx)(n.p,{children:"Net zoals we via minor en patch releases v1 hebben uitgebreid en laten evolueren zullen we dat met v2 doen. Op een\nbepaald moment zullen we terug een opkuis actie willen doen die dan zal resulteren in een v3 release. Een concrete\ndatum of feature-set voor v3 is er nog niet."})]})}let s=()=>{throw Error("Docs-only story")};s.parameters={docsOnly:!0};let a={title:"Planning/Aanpak v2, v3, ...",tags:["stories-mdx"],includeStories:["__page"]};a.parameters=a.parameters||{},a.parameters.docs={...a.parameters.docs||{},page:function(e={}){let{wrapper:n}=Object.assign({},(0,i.RP)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}};let l=a,c=["__page"]}}]);